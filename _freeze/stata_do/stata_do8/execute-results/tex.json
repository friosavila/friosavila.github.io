{
  "hash": "09cacfc4947c5aabc382fd86cb02ab15",
  "result": {
    "markdown": "---\ntitle: Health report\nformat:\n  html: default\n  pdf: default\n  docx: default\n---\n\n::: {.cell execution_count=1}\n``` {.stata .cell-code}\nwebuse nhanes2l, clear\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Second National Health and Nutrition Examination Survey)\n```\n:::\n:::\n\n\nBelow, we load data from the Second National Health and Nutrition\nExamination Survey (NHANES II) (McDowell et al. 1981). We are interested in\nhow health measures differ across diabetics and non-diabetics. \n\n\n\n```{latex}\n\\begin{table}[!h]\n\\caption{Table 1}\n\\centering\n\\begin{tabular}{lllll}\n\\cline{1-5}\n\\multicolumn{1}{r}{} &\n  \\multicolumn{4}{c}{Diabetes status} \\\\\n\\multicolumn{1}{r}{} &\n  \\multicolumn{1}{c}{Not diabetic} &\n  \\multicolumn{1}{c}{Diabetic} &\n  \\multicolumn{1}{c}{Total} &\n  \\multicolumn{1}{c}{Test} \\\\\n\\cline{1-5}\n\\multicolumn{1}{l}{N} &\n  \\multicolumn{1}{r}{9,850 (95.2\\%)} &\n  \\multicolumn{1}{r}{499 (4.8\\%)} &\n  \\multicolumn{1}{r}{10,349 (100.0\\%)} &\n  \\multicolumn{1}{r}{} \\\\\n\\multicolumn{1}{l}{Age (years)} &\n  \\multicolumn{1}{r}{46.9 (17.2)} &\n  \\multicolumn{1}{r}{60.7 (11.5)} &\n  \\multicolumn{1}{r}{47.6 (17.2)} &\n  \\multicolumn{1}{r}{} \\\\\n\\multicolumn{1}{l}{Weight (kg)} &\n  \\multicolumn{1}{r}{71.7 (15.2)} &\n  \\multicolumn{1}{r}{76.7 (17.2)} &\n  \\multicolumn{1}{r}{71.9 (15.4)} &\n  \\multicolumn{1}{r}{} \\\\\n\\multicolumn{1}{l}{Systolic blood pressure} &\n  \\multicolumn{1}{r}{130.1 (22.8)} &\n  \\multicolumn{1}{r}{146.7 (28.4)} &\n  \\multicolumn{1}{r}{130.9 (23.3)} &\n  \\multicolumn{1}{r}{$<$0.001} \\\\\n\\multicolumn{1}{l}{Serum cholesterol (mg/dL)} &\n  \\multicolumn{1}{r}{217.2 (49.2)} &\n  \\multicolumn{1}{r}{227.3 (52.3)} &\n  \\multicolumn{1}{r}{217.7 (49.4)} &\n  \\multicolumn{1}{r}{$<$0.001} \\\\\n\\multicolumn{1}{l}{Serum triglycerides (mg/dL)} &\n  \\multicolumn{1}{r}{141.4 (95.0)} &\n  \\multicolumn{1}{r}{195.1 (111.8)} &\n  \\multicolumn{1}{r}{143.9 (96.5)} &\n  \\multicolumn{1}{r}{$<$0.001} \\\\\n\\multicolumn{1}{l}{Sex} &\n  \\multicolumn{1}{r}{} &\n  \\multicolumn{1}{r}{} &\n  \\multicolumn{1}{r}{} &\n  \\multicolumn{1}{r}{} \\\\\n\\multicolumn{1}{l}{\\hspace{1em}Male} &\n  \\multicolumn{1}{r}{4,698 (47.7\\%)} &\n  \\multicolumn{1}{r}{217 (43.5\\%)} &\n  \\multicolumn{1}{r}{4,915 (47.5\\%)} &\n  \\multicolumn{1}{r}{} \\\\\n\\multicolumn{1}{l}{\\hspace{1em}Female} &\n  \\multicolumn{1}{r}{5,152 (52.3\\%)} &\n  \\multicolumn{1}{r}{282 (56.5\\%)} &\n  \\multicolumn{1}{r}{5,434 (52.5\\%)} &\n  \\multicolumn{1}{r}{} \\\\\n\\cline{1-5}\n\\end{tabular}\n\\end{table}\n```\n\n\n\ndtable age weight bpsystol tcresult tgresult i.sex, by(diabetes, tests) ///\n title(Table 1) continuous(age weight, test(none)) factor(sex, test(none)) ///\n nformat(%6.1f mean sd)\ncollect style putdocx, layout(autofitcontents)\nputdocx collect\n\nputdocx textblock begin\nIn this table, we find strong evidence that the mean systolic blood pressure,\n cholesterol, and triglycerides differ across diabetics and non-diabetics. We\n visualize how systolic blood pressure changes with age group in\n <<dd_docx_display bookmarklink(\"bmark1\"): \"figure 1\">>. We see that systolic\n blood pressure climbs with age, and for individuals in their 30s and older,\n those with diabetes have higher blood pressure than those without, on average.\nputdocx textblock end\n \ngraph bar (mean) bpsystol, over(agegrp) over(diabetes) ///\n asyvars blabel(bar, format(%6.1f)) ytitle(Mean systolic blood pressure)\ngraph export graph1.svg, replace  \n\nputdocx paragraph, halign(center)\nputdocx text (\"Figure 1. Systolic blood pressure and diabetes\"), ///\n bookmark(\"bmark1\")\nputdocx image graph1.svg, linebreak ///\nalt(\"Graph of systolic blood pressure and diabetes\")\n \nputdocx save report1, replace\n \n**# putexcel example\n\nwebuse census, clear\nforeach x of varlist pop death marriage {\n    bysort region: egen avg_`x' = mean(`x')\n}\nexport excel region avg_* pop death marriage state using report2.xlsx, ///\n  firstrow(variables) replace \nputexcel set report2.xlsx, modify \nputexcel sheetset, split(1, 4) \nputexcel save \n\n",
    "supporting": [
      "stata_do8_files\\figure-pdf"
    ],
    "filters": []
  }
}